<!DOCTYPE HTML>
<html><!-- InstanceBegin template="/Templates/main.dwt" codeOutsideHTMLIsLocked="false" -->
    <head>        
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        
        <title>Mobile App</title>        
        
		<link href="http://fonts.googleapis.com/css?family=Open+Sans+Condensed:300,700" 
        rel="stylesheet" type="text/css"/>
        <link href="css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
		<link href="css/jquerymobile.css" rel="stylesheet" type="text/css"/>                
		<!-- nativeDroid core CSS -->
        <link href="css/jquerymobile.nativedroid.css" rel="stylesheet" type="text/css"/>
        
		<!-- nativeDroid: Light/Dark -->
        <link href="css/jquerymobile.nativedroid.dark.css" rel="stylesheet" type="text/css" id='jQMnDTheme'/>
        
		<!-- nativeDroid: Color Schemes -->
        <link href="css/jquerymobile.nativedroid.color.green.css" rel="stylesheet" type="text/css" id='jQMnDColor'/>        	
        <link href="css/style.css" rel="stylesheet" type="text/css"/>
         		       
		<script src="js/jquery-1.11.0.min.js" type="text/javascript"></script>
        <script src="js/jquery.mobile-1.4.2.min.js" type="text/javascript"></script>        
		<script src="js/logger.js" type="text/javascript"></script>
		<script src="cordova.js" type="text/javascript"></script>
		<script src="js/functions.js" type="text/javascript"></script>
		<script type="text/javascript">
        	$(document).ready(function() {
         		allowAccess();				
             	$(document).on( 'pagecreate','#page', function(event){
              		setUserToken();					
             	});	
				getHeaderBgColor();				
        	});
        </script>
	<!-- InstanceBeginEditable name="EditableHead" -->
    <script type="text/javascript">
	
	
	
	//$(document).on('pageinit', '#page',  function(){
        // code 
		
	
    //});
    			$(document).on('pagebeforeshow', function(){
				alert('its working');
				
				driver = 4;
				
				params = {
					callback : 'callbackIsOnduty',
					controller : 'Drivers',
					action : 'isOnduty',
					data : [{
						driverId : driver
					}]
				};

				getAjaxData(params, 'callbackIsOnduty');
				
				$('input[type=checkbox][name=onoffswitch]').click(function() {
					
					if ( $('input[type=checkbox][name=onoffswitch]').is(':checked')) { makeChange = 0; } else { makeChange = 1; }
					
					params = {
					callback : 'callbackChangeDuty',
					controller : 'Drivers',
					action : 'changeOnduty',
					data : [{ changeStatus : makeChange, driverId : driver }]
					};

				getAjaxData(params, 'callbackChangeDuty');
				});

			});

			function callbackIsOnduty(data) {

				if (data.success == true) {

					$.each(data.data, function(key, value) {
						$.each(data.data[key], function(key, value) {
							if (key == 'is_onduty' && value == '0') {

								console.log(key +'=>'+value);
							} else if( key == 'is_onduty' && value == '1' ){

								$('input[type=checkbox][name=onoffswitch]').prop('checked', true);
								//input[type=checkbox]
								console.log(key +'=>'+value);							
							}
							
						})
					});
				} else {

				}
			}
			
			function callbackChangeDuty(data) {

				if (data.success == true) {
					alert('ok');
				} else {

				}
			}

		</script>
	<!-- InstanceEndEditable --> 
    </head>
    
    <body>        
        <div data-role="page" style="">            
            <div data-role="header" data-position="fixed" data-tap-toggle="false" data-theme="e" 
            id="header" class="bg-black">
                <div class="container">
                	<div class="top-icons ti-left">
                    	<a href="#" data-ajax="false" target="_blank">
                            <i class="icon-android"></i>
                        </a>
                    </div>                	
                    
                    <div id="header-logo">
                        <div class="tile-box text-center">
                            <a href="dashboard.html" rel="external">
                                <img src="images/taxi-logo.png" alt="Get a Taxi App">
                            </a>
                        </div>
                    </div>                                   
                    
                    <div class="top-icons ti-right">
                    	<a href="#">
                            <i class="icon-user"></i>
                        </a>
                        <a href="#">
                            <i class="icon-cogs"></i>
                        </a>                        
                    </div>
                    
                <!-- InstanceBeginEditable name="EditableHeader" -->
            <script type="text/javascript">

				</script>
		<!-- InstanceEndEditable -->
                <div class="clearfix"></div>
                </div>
            </div>               
        
        
            <div id="content"> 
                <div class="container">
                <!-- InstanceBeginEditable name="EditableBody" -->

	<div class="my-profile-bg content-position"> 
    	<h2>My Status</h2>        
             <div id="result"></div>       
             
             <div class="onoffswitch">
                <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch" data-role="none">
                <label class="onoffswitch-label" for="myonoffswitch" data-role="none">
                    <div class="onoffswitch-inner"></div>
                    <div class="onoffswitch-switch"></div>
                </label>
                

            </div>  
            </br>
            </br>
            </br>
        	
                <a href="dashboard.html" data-transition="flip" style="color:#FFF">Dashboard</a> 
                <a href="register.html" data-transition="slide" style="color:#FFF">Register</a>
                <a href="get-quote.html" style="color:#FFF" rel="external">Get-Quote</a>      
                <a href="push.html" style="color:#FFF" rel="external">Get-Push</a>              

	</div>        
                                
		<!-- InstanceEndEditable -->
                </div>
                <div class="clearfix"></div>
            </div>
            
            <div data-position="fixed" data-tap-toggle="false" data-role="footer" 
            data-tap-toggle="false" data-theme="b" id="footer">
                <div class="container">
                    <div data-role="navbar">
                        <ul>
                            <li>
                                <a href="index.html">
                                    <i class="icon-home"></i>
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <i class="icon-picture"></i>
                                </a>
                            </li>
                            <li>
                                <a href="logout.htnl" id="logout">
                                    <i class="icon-signout"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <!-- InstanceBeginEditable name="EditableFooter" -->
	
	<!-- InstanceEndEditable -->
                </div>
            </div>            
        </div>
	</body>
<!-- InstanceEnd --></html>
